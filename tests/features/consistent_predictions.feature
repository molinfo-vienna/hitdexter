@hitdexter
Feature: Consistent predictions

  Scenario Outline: Predictions stay consistent with previous versions
    Given an input molecule specified by '<input_smiles>'
    And the input type is 'smiles'
    
    When the HitDexter 3 model generates predictions for the molecule representations
    And the subset of the result where the input was not None is considered
    
    Then the value in column 'name' should be equal to '<name>'
    And the value in column 'mol_weight' should be equal to <mol_weight>
    And the value in column 'mol_clogp' should be equal to <clogp>
    And the value in column 'prediction_1' should be equal to <prediction_1>
    And the value in column 'distance_to_neighbor_1' should be equal to <neighbor_1>
    And the value in column 'prediction_2' should be equal to <prediction_2>
    And the value in column 'distance_to_neighbor_2' should be equal to <neighbor_2>
    And the value in column 'prediction_3' should be equal to <prediction_3>
    And the value in column 'distance_to_neighbor_3' should be equal to <neighbor_3>
    And the value in column 'prediction_4' should be equal to <prediction_4>
    And the value in column 'distance_to_neighbor_4' should be equal to <neighbor_4>
    And the value in column 'prediction_5' should be equal to <prediction_5>
    And the value in column 'distance_to_neighbor_5' should be equal to <neighbor_5>
    And the value in column 'prediction_6' should be equal to <prediction_6>
    And the value in column 'distance_to_neighbor_6' should be equal to <neighbor_6>

    Examples:
    | input_smiles                                                                                                  | name                     | preprocessed_smiles                                                                             | mol_weight | clogp  | prediction_2 | neighbor_2 | prediction_1 | neighbor_1 | prediction_4 | neighbor_4 | prediction_3 | neighbor_3 | prediction_6 | neighbor_6 | prediction_5 | neighbor_5 | distance_dcm | distance_bad_actor | pattern_1 | pattern_2                                                           | pattern_3                                               | pattern_4                 | pattern_5                                                                                         | pattern_6                                                                                                                                         | pattern_7                                              | pattern_8                | error                                                         |
    | C1=NC2=C(N1COCCO)N=C(NC2=O)N Aciclovir                                                                        | Aciclovir                | Nc1nc(=O)c2ncn(COCCO)c2[nH]1                                                                    | 225.21     | -1.33  | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0.75               | []        | []                                                                  | []                                                      | []                        | []                                                                                                | []                                                                                                                                                | []                                                     | []                       | A1                                                            |
    | CCN(CC)CCOc1c(I)cc(cc1I)C(=O)c2c3ccccc3oc2CCCC Amiodarone                                                     | Amiodarone               | CCCCc1oc2ccccc2c1C(=O)c1cc(I)c(OCCN(CC)CC)c(I)c1                                                | 645.32     | 6.94   | 0            | 0.57       | 0            | 0.58       | 0            | 0.57       | 0            | 0.58       | 1            | 0          | 0            | 0.57       | 0.62         | 0                  | []        | []                                                                  | ['I']                                                   | []                        | ['I-c:*']                                                                                         | ['[!#6;!#7;!#8;!#16;!#1;!#3;!#9;!#11;!#12;!#15;!#17;!#19;!#20;!#30;!#35]', '[#6]-C(=O)-[#6]']                                                     | ['*!@c1c(!@*)c(!@*)c(!@*)c(!@*)c1']                    | []                       | A1,NNTBHPROM,NNTBPROM,NNCBHPROM,NNCBPROM,NNECBHPROM           |
    | C1=CC(=C(C=C1[As]=[As]C2=CC(=C(C=C2)O)N)N)O.Cl.Cl Arsphenamine (Salvarsan)                                    | Arsphenamine (Salvarsan) | None                                                                                            | None       | None   | None         | None       | None         | None       | None         | None       | None         | None       | None         | None       | None         | None       | None         | None               | None      | None                                                                | None                                                    | None                      | None                                                                                              | None                                                                                                                                              | None                                                   | None                     | !1                                                            |
    | C1CNP(=O)(OC1)N(CCCl)CCCl Cyclophosphamide                                                                    | Cyclophosphamide         | O=P1(N(CCCl)CCCl)NCCCO1                                                                         | 261.09     | 1.88   | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0.69         | 0                  | []        | ['[#15]~[N,n]', '[CH2][Cl,Br,I,$(O(S(=O)(=O)[!$(N);!$([O&D1])]))]'] | ['[CX4][Cl,Br,I]', 'P']                                 | ['[Br,Cl,I][CX4;CH,CH2]'] | ['[S,P](=O)OC', 'P(=[O,S])[C,N]([C,N])[C,N]', '[N,S,O][CH2][CH2]-[F,Cl,Br,I]', '[CH2]-[Cl,Br,I]'] | ['[Br,Cl,I][CX4,CH,CH2,CH3]']                                                                                                                     | ['[Br,Cl,I][CX4;CH,CH2]']                              | []                       | A1                                                            |
    | C[C@H]1[C@H]([C@H](C[C@@H](O1)O[C@H]2C[C@@](Cc3c2c(c4c(c3O)C(=O)c5cccc(c5C4=O)OC)O)(C(=O)CO)O)N)O Doxorubicin | Doxorubicin              | COc1cccc2c(O)c3c(O)c4c(c(O)c3c(O)c12)=C(O[C@H]1C[C@H](N)[C@H](O)[C@H](C)O1)C[C@](O)(C(=O)CO)C=4 | 543.53     | -0.75  | 1            | 0          | 1            | 0          | 1            | 0          | 1            | 0          | 1            | 0          | 1            | 0          | 0.71         | 0                  | []        | []                                                                  | ['[OH]c1ccc([OH,NH2,NH])cc1', 'a21aa3a(aa1aaaa2)aaaa3'] | []                        | ['a1aaa2a(a1)aaa(a2):a']                                                                          | ['[OH1]c1ccc([OH1])cc1', '[#6]-O[CH1](-[#6])O-[#6]', '[#6]-C(=O)-[#6]', 'c12:[c,n]:[c,n]:[c,n]:[c,n]:c1[c,n]c3:[c,n]:[c,n]:[c,n]:[c,n]:c3[c,n]2'] | ['c1cccc(cc(cccc2)c2c3)c13']                           | ['[OH1]c1ccc([OH1])cc1'] | A1                                                            |
    | O=S(=O)(N)c1c(Cl)cc2c(c1)S(=O)(=O)NCN2 Hydrochlorothiazide                                                    | Hydrochlorothiazide      | NS(=O)(=O)c1cc2c(cc1Cl)NCNS2(=O)=O                                                              | 297.74     | -0.35  | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0.35         | 0.78               | []        | []                                                                  | []                                                      | []                        | []                                                                                                | ['*[N,S,O]-&!@[N,S,O][#6]']                                                                                                                       | []                                                     | []                       | A1                                                            |
    | C[C@H]1COc2c3n1cc(c(=O)c3cc(c2N4CCN(CC4)C)F)C(=O)O Levofloxacin                                               | Levofloxacin             | C[C@H]1COc2c(N3CCN(C)CC3)c(F)cc3c(=O)c(C(=O)O)cn1c23                                            | 361.37     | 1.54   | 0            | 0.27       | 0            | 0.27       | 1            | 0          | 0            | 0.27       | 1            | 0          | 0            | 0.43       | 0.63         | 0.78               | []        | []                                                                  | []                                                      | []                        | []                                                                                                | []                                                                                                                                                | []                                                     | []                       | A1                                                            |
    | CC1=C(C(=O)N(N1C)C2=CC=CC=C2)N(C)CS(=O)(=O)[O-].O.[Na+] Metamizole (Sulpyrine)                                | Metamizole (Sulpyrine)   | Cc1c(N(C)CS(=O)(=O)O)c(=O)n(-c2ccccc2)n1C                                                       | 311.36     | 0.77   | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0            | 0          | 0.43         | 0.75               | []        | []                                                                  | ['S(=O)(=O)[O-,OH]']                                    | []                        | ['[P,S](~O)(~O)~O']                                                                               | ['[OH]-S(=O)(=O)-*', '*[N,S,O]-&!@[N,S,O][#6]']                                                                                                   | ['[#6]S(=O)(=O)O', '*!@c1c(!@*)c(!@*)c(!@*)c(!@*)c1']  | []                       | A1                                                            |
    | CC1=C(C(C(=C(N1C=O)C)C(=O)OC)C2=CC=CC=C2[N+](=O)[O-])C(=O)OC Nifedipine                                       | Nifedipine               | COC(=O)C1=C(C)N(C=O)C(C)=C(C(=O)OC)C1c1ccccc1[N+](=O)[O-]                                       | 374.35     | 2.04   | 0.34         | 0.5        | 0.06         | 0.51       | 0            | 0.5        | 0            | 0.51       | 0            | 0.5        | 0            | 0.51       | 0.51         | 0.7                | []        | []                                                                  | ['[CH1](=O)', '[N+](=O)[O-]', '[OR0,NR0][OR0,NR0]']     | []                        | ['O~N(=O)-c(:*):*', 'O=[C!H0]']                                                                   | ['[#6]-C(=O)O-[#6]', 'c([N+](=O)[O-])', '*=,:[#6]C([#6]=,:*)[#6]=,:*']                                                                            | ['O=[CH][O,N][#6]', '*!@c1c(!@*)c(!@*)c(!@*)c(!@*)c1'] | []                       | A1,NNTBHPROM,NNCBHPROM,NNECBHPROM                             |
    | OC=1c3ccccc3OC(=O)C=1C(CC)c2ccccc2 Phenprocoumon                                                              | Phenprocoumon            | CCC(c1ccccc1)c1c(O)c2ccccc2oc1=O                                                                | 280.32     | 4.04   | 0            | 0.27       | 0            | 0.27       | 0            | 0.27       | 0            | 0.27       | 0            | 0.4        | 0            | 0.42       | 0.42         | 0.71               | []        | []                                                                  | ['c1ccc2c(c1)ccc(=O)o2']                                | []                        | []                                                                                                | []                                                                                                                                                | ['*!@c1c(!@*)c(!@*)c(!@*)c(!@*)c1']                    | []                       | A1                                                            |
    | O=C1COCCN1c2ccc(cc2)N3C[C@@H](OC3=O)CNC(=O)c4ccc(s4)Cl Rivaroxaban                                            | Rivaroxaban              | O=C(NC[C@H]1CN(c2ccc(N3CCOCC3=O)cc2)C(=O)O1)c1ccc(Cl)s1                                         | 435.89     | 2.52   | 0            | 0.54       | 0            | 0.54       | 0            | 0.56       | 0            | 0.56       | 0            | 0.54       | 0            | 0.54       | 0.54         | 0.79               | []        | []                                                                  | []                                                      | []                        | []                                                                                                | []                                                                                                                                                | ['*!@c1c(!@*)c(!@*)c(!@*)c(!@*)c1']                    | []                       | A1,NNTBHPROM,NNTBPROM,NNCBHPROM,NNCBPROM,NNECBHPROM,NNECBPROM |

